SIGNAL void testCase2(){

  int pos;
  int i;
  int lastPulsePinValue;
  int flag;
  
  reached2 = 0;
  reached3 = 0;
  pos = 0;
  flag = 1;		//Can't accept the request to Stop at the floor.
  
  // close the doors
  PORTC |= 1 << 8;
  
  // let's go to floor 3
  printf("going to floor 3\n");
  PORTC |= 1 << 2;
// Count the pulses till 13s to accept the request
// to stop at 2nd Floor, otherwise keep going to 3rd Floor

	
	lastPulsePinValue = PORTC & (1 << 9);
	for(i = 0; i < 5200; ++i)
	{
		if (lastPulsePinValue < (PORTC & (1 << 9))) {
      if (TIM3_CCR1) pos += 1;
      if (TIM3_CCR2) pos -= 1; 
    }
    lastPulsePinValue = PORTC & (1 << 9);
    swatch(0.0025);
  }
  
  //Lift is just 2 seconds below its reaching time to the 
  // 2nd Floor. So now take the request from 2nd Floor.
  
  PORTC ^= 1 << 2;
  PORTC |= 1 << 1;	//Gets Request from 2nd Floor.
  
  for (i = 0; i < 400; ++i) {
    if (lastPulsePinValue < (PORTC & (1 << 9))) {
      if (TIM3_CCR1) pos += 1;
      if (TIM3_CCR2) pos -= 1;
    }
    lastPulsePinValue = PORTC & (1 << 9);
    swatch(0.0025);
  }
		
	//After Getting request from the 2nd Floor, we need to 
	//verify that the motor should not stop between 
	//position 399 & 401.
	
	PORTC ^= 1 << 1;
	
	flag = flag & (pos >= 399 && pos <= 401 &&
				    (PORTC & (1 << 7)))  && TIM_CCR1)
	
	
	if(!flag)
	{
		while(1){
		
			printf("Test-case failed: Lift Stopped at Floor 2.")
			swatch(0.1);
		}
	}
	
	if(flag){
	
		for(i = 0; i < 34 && (!reached3 || !reached2); ++i){
		at_floor = 0;
		
		//every second, check whether we are at a floor
		if((PORTC & (1 << 7) && !TIM3_CCR1 && !TIM3_CCR2){
		
			if(pos >= 799 && pos <= 801 && !reached3)
				{
					printf("Arrived at floor 3\n");
					reached3 = 1;
					at_floor = 1;
				}
			
			if(pos >= 399 && pos <= 401 && !reached2)
				{
					printf("Arrived at floor 2\n");
					reached2 = 1;
					at_floor = 1;
				}
		}	
		
	//Open Door
	if(at_floor)
	PORTC ^= 1 << 8;
	
	// wait 1s
    for (i = 0; i < 400; ++i) {
      if (lastPulsePinValue < (PORTC & (1 << 9))) {
        if (TIM3_CCR1) pos += 1;
        if (TIM3_CCR2) pos -= 1;
      }
      lastPulsePinValue = PORTC & (1 << 9);
      swatch(0.0025);
    }
	
	//Close Door
	if (at_floor)
      PORTC ^= 1 << 8;
		
	}

	if (!reached3) {
    while (1) {
      printf("Test-case failed: did not get to floor 3!\n");
      swatch(0.02);
    }
  }
  
  if (!reached2) {
    while (1) {
      printf("Test-case failed: did not get to floor 2!\n");
      swatch(0.02);
    }
  }
  
  while (1) {
    printf("Test-case succeeded\n");
    swatch(0.02);
  }

}